<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUTANDA TRADERS | Premium Quality Products</title>
    <link rel="icon" type="image/png" href="icons/icon-96.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { 
            getFirestore, 
            collection, 
            getDocs, 
            addDoc,
            serverTimestamp,
            doc,
            updateDoc,
            increment
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC4MHkpXUrnnQiaB4ru9q5CvJoQMwJRv1g",
            authDomain: "aj-shop-e10b7.firebaseapp.com",
            projectId: "aj-shop-e10b7",
            storageBucket: "aj-shop-e10b7.firebasestorage.app",
            messagingSenderId: "259849089139",
            appId: "1:259849089139:web:7cee95b18d5e0c90103a06",
            measurementId: "G-4YZQPLNR3F"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.firestore = {
            db,
            getDocs,
            collection,
            addDoc,
            serverTimestamp,
            doc,
            updateDoc,
            increment
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #1a5f23;
            --primary-dark: #14521c;
            --primary-light: #2e8b57;
            --secondary-color: #f8b400;
            --secondary-dark: #d89c00;
            --light-bg: #f8f9fa;
            --dark-text: #2d3748;
            --light-text: #718096;
            --border-color: #e2e8f0;
            --success-color: #38a169;
            --danger-color: #e53e3e;
            --warning-color: #d69e2e;
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.15);
            --border-radius-sm: 8px;
            --border-radius-md: 12px;
            --border-radius-lg: 16px;
            --border-radius-xl: 24px;
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: var(--dark-text);
            line-height: 1.6;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Enhanced Header with Search */
        .header {
            background: white;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-sm);
            border-bottom: 1px solid var(--border-color);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            min-width: 200px;
        }

        .logo-icon {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            width: 40px;
            height: 40px;
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .logo-text {
            display: flex;
            flex-direction: column;
            line-height: 1.2;
        }

        .logo-main {
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--primary-color);
            letter-spacing: -0.5px;
        }

        .logo-sub {
            font-size: 0.75rem;
            color: var(--light-text);
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        /* Search Bar */
        .search-container {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-box {
            width: 100%;
            padding: 12px 20px 12px 45px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            font-size: 1rem;
            transition: all var(--transition-fast);
            background: var(--light-bg);
        }

        .search-box:focus {
            outline: none;
            border-color: var(--primary-color);
            background: white;
            box-shadow: 0 0 0 3px rgba(26, 95, 35, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--light-text);
        }

        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-lg);
            margin-top: 5px;
            max-height: 400px;
            overflow-y: auto;
            display: none;
            z-index: 1000;
        }

        .search-results.active {
            display: block;
        }

        .search-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .search-item:hover {
            background: var(--light-bg);
        }

        .search-item-image {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: var(--border-radius-sm);
            margin-right: 15px;
        }

        .search-item-info {
            flex: 1;
        }

        .search-item-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .search-item-price {
            color: var(--primary-color);
            font-weight: 700;
        }

        .no-results {
            padding: 20px;
            text-align: center;
            color: var(--light-text);
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
            min-width: 200px;
            justify-content: flex-end;
        }

        .cart-toggle {
            position: relative;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--border-radius-md);
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all var(--transition-normal);
            box-shadow: var(--shadow-sm);
        }

        .cart-toggle:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--secondary-color);
            color: var(--dark-text);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 800;
        }

        /* Enhanced Mobile Header */
        .mobile-header {
            display: none;
            background: white;
            padding: 12px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-sm);
            border-bottom: 1px solid var(--border-color);
        }

        .mobile-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
        }

        .mobile-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }

        .mobile-logo-icon {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            width: 36px;
            height: 36px;
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
        }

        .mobile-logo-text {
            font-size: 1.1rem;
            font-weight: 800;
            color: var(--primary-color);
            letter-spacing: -0.5px;
        }

        .mobile-search-toggle {
            background: none;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .mobile-search-toggle:hover {
            background: var(--light-bg);
        }

        .mobile-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .mobile-cart-btn {
            position: relative;
            background: var(--primary-color);
            border: none;
            width: 44px;
            height: 44px;
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .mobile-cart-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .mobile-cart-count {
            position: absolute;
            top: -6px;
            right: -6px;
            background: var(--secondary-color);
            color: var(--dark-text);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 800;
        }

        /* Mobile Search Overlay */
        .mobile-search-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            display: none;
            align-items: flex-start;
            justify-content: center;
            padding-top: 100px;
            animation: fadeIn 0.3s ease;
        }

        .mobile-search-overlay.active {
            display: flex;
        }

        .mobile-search-container {
            width: 90%;
            max-width: 500px;
        }

        .mobile-search-box {
            width: 100%;
            padding: 20px 20px 20px 50px;
            border: none;
            border-radius: var(--border-radius-md);
            font-size: 1.2rem;
            background: white;
            color: var(--dark-text);
        }

        .mobile-search-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-color);
            font-size: 1.2rem;
        }

        .close-search {
            position: absolute;
            top: 30px;
            right: 30px;
            background: var(--danger-color);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }

        .close-search:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-md);
        }

        /* Enhanced Banner */
        .banner {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-color) 50%, var(--primary-light) 100%);
            color: white;
            padding: 80px 0;
            position: relative;
            overflow: hidden;
            margin-bottom: 60px;
        }

        .banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.1;
        }

        .banner-content {
            position: relative;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .banner h1 {
            font-size: 3rem;
            margin-bottom: 24px;
            font-weight: 800;
            line-height: 1.2;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            background: linear-gradient(to right, #ffffff, #f0f0f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .banner p {
            font-size: 1.25rem;
            opacity: 0.95;
            margin-bottom: 40px;
            font-weight: 400;
        }

        .banner-btn {
            background: var(--secondary-color);
            color: var(--dark-text);
            border: none;
            padding: 16px 40px;
            border-radius: var(--border-radius-md);
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all var(--transition-normal);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            box-shadow: var(--shadow-md);
        }

        .banner-btn:hover {
            background: var(--secondary-dark);
            transform: translateY(-3px) scale(1.05);
            box-shadow: var(--shadow-lg);
        }

        /* Enhanced Products Section */
        .products-section {
            padding: 60px 0;
            background: white;
            border-radius: var(--border-radius-xl) var(--border-radius-xl) 0 0;
            box-shadow: var(--shadow-lg);
            margin-top: -30px;
            position: relative;
            z-index: 1;
        }

        .section-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .section-title {
            font-size: 2.2rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            font-weight: 800;
            letter-spacing: -0.5px;
        }

        .section-subtitle {
            color: var(--light-text);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Products Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 25px;
        }

        @media (min-width: 480px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (min-width: 1200px) {
            .products-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* Enhanced Product Card */
        .product-card {
            background: white;
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
            border: 1px solid var(--border-color);
            position: relative;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-color);
        }

        .product-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--secondary-color);
            color: var(--dark-text);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            z-index: 1;
        }

        .product-image-container {
            width: 100%;
            padding-top: 100%;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            cursor: pointer;
        }

        .product-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform var(--transition-slow);
        }

        .product-card:hover .product-image {
            transform: scale(1.1);
        }

        /* Quick View Overlay */
        .quick-view-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(26, 95, 35, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity var(--transition-normal);
            cursor: pointer;
        }

        .product-image-container:hover .quick-view-overlay {
            opacity: 1;
        }

        .quick-view-text {
            color: white;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
        }

        .product-info {
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .product-category {
            color: var(--primary-color);
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .product-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--dark-text);
            line-height: 1.4;
            height: 2.8em;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .product-price {
            color: var(--primary-color);
            font-weight: 800;
            font-size: 1.3rem;
            margin-top: auto;
        }

        .product-specs {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .spec-badge {
            background: var(--light-bg);
            color: var(--light-text);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .product-actions {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .view-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all var(--transition-fast);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .view-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .add-to-cart-btn {
            background: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            padding: 12px;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all var(--transition-fast);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .add-to-cart-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .add-to-cart-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Enhanced Product View Page */
        .product-view-page {
            padding: 40px 0;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
        }

        .back-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
            padding: 12px 0;
            font-weight: 600;
            transition: all var(--transition-fast);
        }

        .back-btn:hover {
            gap: 15px;
        }

        .product-view-container {
            background: white;
            border-radius: var(--border-radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
        }

        .product-view-content {
            display: flex;
            flex-direction: column;
        }

        @media (min-width: 992px) {
            .product-view-content {
                flex-direction: row;
            }
        }

        .product-view-image {
            flex: 1;
            padding: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }

        .product-view-image img {
            max-width: 100%;
            max-height: 500px;
            object-fit: contain;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-md);
            transition: transform 0.5s ease;
        }

        .product-view-image img:hover {
            transform: scale(1.05);
        }

        .product-view-details {
            flex: 1;
            padding: 40px;
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .product-view-header {
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 20px;
        }

        .product-view-title {
            font-size: 2.2rem;
            color: var(--dark-text);
            margin-bottom: 10px;
            font-weight: 800;
            line-height: 1.2;
        }

        .product-view-price {
            font-size: 1.8rem;
            color: var(--primary-color);
            font-weight: 800;
        }

        .product-view-description {
            color: var(--light-text);
            line-height: 1.8;
            font-size: 1.1rem;
        }

        /* Product Specifications */
        .product-specifications {
            background: var(--light-bg);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            margin-top: 20px;
        }

        .specifications-title {
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-weight: 700;
        }

        .specifications-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        @media (max-width: 768px) {
            .specifications-grid {
                grid-template-columns: 1fr;
            }
        }

        .spec-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .spec-label {
            font-weight: 600;
            color: var(--dark-text);
        }

        .spec-value {
            color: var(--light-text);
        }

        /* Size and Color Selectors */
        .size-selector, .color-selector {
            margin-top: 20px;
        }

        .selector-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark-text);
        }

        .size-options, .color-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .size-option {
            width: 40px;
            height: 40px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: 600;
            transition: all var(--transition-fast);
        }

        .size-option:hover, .size-option.active {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: white;
        }

        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all var(--transition-fast);
        }

        .color-option:hover, .color-option.active {
            border-color: var(--primary-color);
            transform: scale(1.1);
        }

        .product-view-meta {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            background: var(--light-bg);
            padding: 25px;
            border-radius: var(--border-radius-lg);
        }

        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .meta-label {
            font-size: 0.9rem;
            color: var(--light-text);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .meta-value {
            font-weight: 700;
            color: var(--dark-text);
            font-size: 1.1rem;
        }

        .stock-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .stock-in {
            background: #c6f6d5;
            color: #22543d;
        }

        .stock-low {
            background: #feebc8;
            color: #744210;
        }

        .stock-out {
            background: #fed7d7;
            color: #742a2a;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }

        .quantity-btn {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--border-color);
            width: 40px;
            height: 40px;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: 700;
            transition: all var(--transition-fast);
        }

        .quantity-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: scale(1.1);
        }

        .quantity-display {
            font-weight: 700;
            font-size: 1.1rem;
            min-width: 40px;
            text-align: center;
        }

        .buy-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 20px;
            border-radius: var(--border-radius-md);
            font-size: 1.2rem;
            font-weight: 800;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all var(--transition-normal);
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: var(--shadow-md);
            margin-top: 20px;
        }

        .buy-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .buy-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Enhanced Cart Page - FIXED for Mobile */
        .cart-page {
            padding: 40px 0;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
        }

        .cart-container {
            background: white;
            border-radius: var(--border-radius-xl);
            padding: 40px;
            box-shadow: var(--shadow-xl);
        }

        @media (max-width: 768px) {
            .cart-container {
                padding: 20px;
            }
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
            flex-wrap: wrap;
            gap: 15px;
        }

        .cart-title {
            font-size: 2rem;
            color: var(--dark-text);
            font-weight: 800;
            letter-spacing: -0.5px;
            flex: 1;
            min-width: 200px;
        }

        .cart-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        @media (max-width: 480px) {
            .cart-actions {
                width: 100%;
            }
            
            .cart-actions button, 
            .cart-actions a {
                flex: 1;
                min-width: 140px;
            }
        }

        .clear-cart {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--border-radius-md);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            transition: all var(--transition-fast);
            white-space: nowrap;
        }

        .clear-cart:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .continue-shopping {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--border-radius-md);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            transition: all var(--transition-fast);
            text-decoration: none;
            white-space: nowrap;
        }

        .continue-shopping:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .cart-items {
            margin-bottom: 40px;
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 25px;
            border-bottom: 1px solid var(--border-color);
            gap: 25px;
            transition: all var(--transition-fast);
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .cart-item {
                flex-direction: column;
                text-align: center;
                gap: 15px;
                padding: 20px;
            }
            
            .cart-item-image {
                width: 100%;
                height: 200px;
            }
            
            .cart-item-info {
                width: 100%;
            }
        }

        .cart-item:hover {
            background: var(--light-bg);
            border-radius: var(--border-radius-md);
        }

        .cart-item-image {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-md);
        }

        .cart-item-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .cart-item-name {
            font-weight: 700;
            color: var(--dark-text);
            font-size: 1.2rem;
        }

        .cart-item-price {
            color: var(--primary-color);
            font-weight: 800;
            font-size: 1.3rem;
        }

        .cart-item-specs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 5px;
        }

        .cart-item-spec {
            background: var(--light-bg);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.85rem;
            color: var(--light-text);
        }

        .cart-summary {
            background: var(--light-bg);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            margin-top: 40px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            font-size: 1.1rem;
        }

        .summary-row.total {
            font-weight: 800;
            color: var(--dark-text);
            font-size: 1.5rem;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid var(--border-color);
        }

        .total-amount {
            color: var(--primary-color);
            font-weight: 800;
        }

        .shipping-note {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 5px;
        }

        .checkout-btn {
            width: 100%;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 22px;
            border-radius: var(--border-radius-md);
            cursor: pointer;
            font-weight: 800;
            font-size: 1.3rem;
            margin-top: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            transition: all var(--transition-normal);
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: var(--shadow-md);
        }

        .checkout-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .checkout-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Enhanced Checkout Page */
        .checkout-page {
            padding: 40px 0;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
        }

        .checkout-container {
            background: white;
            border-radius: var(--border-radius-xl);
            padding: 40px;
            box-shadow: var(--shadow-xl);
        }

        @media (max-width: 768px) {
            .checkout-container {
                padding: 20px;
            }
        }

        .checkout-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .checkout-title {
            font-size: 2.2rem;
            color: var(--dark-text);
            margin-bottom: 15px;
            font-weight: 800;
            letter-spacing: -0.5px;
        }

        .checkout-subtitle {
            color: var(--light-text);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto 25px;
        }

        .checkout-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 40px;
        }

        @media (min-width: 992px) {
            .checkout-content {
                grid-template-columns: 1fr 1fr;
            }
        }

        .order-summary {
            background: var(--light-bg);
            border-radius: var(--border-radius-lg);
            padding: 30px;
        }

        .order-summary-title {
            font-size: 1.5rem;
            color: var(--dark-text);
            margin-bottom: 25px;
            font-weight: 700;
        }

        .order-items {
            margin-bottom: 30px;
            max-height: 300px;
            overflow-y: auto;
        }

        .order-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .order-item:last-child {
            border-bottom: none;
        }

        .order-item-name {
            font-weight: 600;
            color: var(--dark-text);
            flex: 1;
        }

        .order-item-quantity {
            color: var(--light-text);
            font-size: 0.9rem;
            margin-left: 10px;
        }

        .order-item-price {
            font-weight: 700;
            color: var(--primary-color);
            min-width: 100px;
            text-align: right;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark-text);
            font-size: 1rem;
        }

        .form-control {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            font-size: 1rem;
            transition: all var(--transition-fast);
            background: white;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(26, 95, 35, 0.1);
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 10px;
        }

        @media (max-width: 768px) {
            .payment-methods {
                grid-template-columns: repeat(1, 1fr);
            }
        }

        .payment-method {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .payment-method:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .payment-method.active {
            border-color: var(--primary-color);
            background: rgba(26, 95, 35, 0.05);
        }

        .payment-icon {
            font-size: 2rem;
            color: var(--primary-color);
        }

        .payment-name {
            font-weight: 600;
            color: var(--dark-text);
            font-size: 0.9rem;
        }

        .checkout-actions {
            display: flex;
            gap: 20px;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        @media (max-width: 480px) {
            .checkout-actions {
                flex-direction: column;
            }
            
            .checkout-actions button {
                width: 100%;
            }
        }

        .back-to-cart {
            flex: 1;
            background: var(--light-text);
            color: white;
            border: none;
            padding: 20px;
            border-radius: var(--border-radius-md);
            cursor: pointer;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all var(--transition-normal);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            min-width: 200px;
        }

        .back-to-cart:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .place-order {
            flex: 2;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 20px;
            border-radius: var(--border-radius-md);
            cursor: pointer;
            font-weight: 800;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            transition: all var(--transition-normal);
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: var(--shadow-md);
            min-width: 200px;
        }

        .place-order:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        /* Enhanced Success Modal - FIXED for Mobile */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 5000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
            padding: 20px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius-xl);
            padding: 50px;
            max-width: 600px;
            width: 100%;
            text-align: center;
            box-shadow: var(--shadow-xl);
            animation: slideUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-height: 90vh;
            overflow-y: auto;
        }

        @media (max-width: 768px) {
            .modal-content {
                padding: 30px 20px;
            }
        }

        @keyframes slideUp {
            from { transform: translateY(50px) scale(0.9); opacity: 0; }
            to { transform: translateY(0) scale(1); opacity: 1; }
        }

        .success-icon {
            font-size: 80px;
            color: var(--success-color);
            margin-bottom: 30px;
            animation: bounce 1s ease infinite;
        }

        @media (max-width: 768px) {
            .success-icon {
                font-size: 60px;
            }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .modal-title {
            font-size: 2.2rem;
            color: var(--dark-text);
            margin-bottom: 20px;
            font-weight: 800;
        }

        @media (max-width: 768px) {
            .modal-title {
                font-size: 1.8rem;
            }
        }

        .modal-message {
            color: var(--light-text);
            margin-bottom: 40px;
            line-height: 1.8;
            font-size: 1.1rem;
        }

        @media (max-width: 768px) {
            .modal-message {
                font-size: 1rem;
                margin-bottom: 30px;
            }
        }

        .order-details {
            background: var(--light-bg);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            margin: 30px 0;
            text-align: left;
        }

        @media (max-width: 768px) {
            .order-details {
                padding: 15px;
                margin: 20px 0;
            }
        }

        .order-details h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .order-details p {
            color: var(--light-text);
            margin-bottom: 10px;
            font-size: 0.95rem;
        }

        .continue-btn {
            width: 100%;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 20px;
            border-radius: var(--border-radius-md);
            cursor: pointer;
            font-weight: 800;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            transition: all var(--transition-normal);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 20px;
        }

        .continue-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        /* Enhanced Toast Notification */
        .toast {
            position: fixed;
            top: 30px;
            right: 30px;
            background: white;
            padding: 20px 25px;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-xl);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 6000;
            transform: translateX(150%);
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-width: 400px;
            border-left: 5px solid var(--primary-color);
        }

        @media (max-width: 768px) {
            .toast {
                top: 20px;
                right: 20px;
                left: 20px;
                max-width: none;
            }
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast-icon {
            font-size: 24px;
            color: var(--primary-color);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 800;
            margin-bottom: 5px;
            color: var(--dark-text);
            font-size: 1rem;
        }

        .toast-message {
            font-size: 0.95rem;
            color: var(--light-text);
            line-height: 1.5;
        }

        .toast.toast-error {
            border-left-color: var(--danger-color);
        }

        .toast.toast-error .toast-icon {
            color: var(--danger-color);
        }

        .toast.toast-success {
            border-left-color: var(--success-color);
        }

        .toast.toast-success .toast-icon {
            color: var(--success-color);
        }

        .toast.toast-warning {
            border-left-color: var(--warning-color);
        }

        .toast.toast-warning .toast-icon {
            color: var(--warning-color);
        }

        /* Loading Spinner */
        .loading {
            text-align: center;
            padding: 60px;
            color: var(--primary-color);
            grid-column: 1 / -1;
        }

        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid rgba(26, 95, 35, 0.2);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Enhanced Footer */
        .footer {
            background: var(--dark-text);
            color: white;
            padding: 60px 0 30px;
            margin-top: 60px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 40px;
        }

        @media (min-width: 768px) {
            .footer-content {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .footer-section h3 {
            font-size: 1.3rem;
            margin-bottom: 25px;
            font-weight: 700;
            color: white;
        }

        .footer-section p {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .developer-credit {
            text-align: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .developer-info {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .developer-info a {
            color: var(--primary-light);
            text-decoration: none;
        }

        .developer-info a:hover {
            text-decoration: underline;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            margin-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .text-ugx {
            font-weight: 800;
        }

        .currency-symbol {
            font-size: 0.9em;
            margin-right: 2px;
        }

        /* Image Zoom Modal */
        .image-zoom-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 6000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .image-zoom-modal.active {
            display: flex;
        }

        .zoomed-image {
            max-width: 90%;
            max-height: 90vh;
            object-fit: contain;
            border-radius: var(--border-radius-lg);
            animation: zoomIn 0.3s ease;
        }

        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .close-zoom {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--danger-color);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
            z-index: 6001;
        }

        .close-zoom:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-md);
        }

        /* Responsive Styles */
        @media (max-width: 992px) {
            .header {
                display: none;
            }
            
            .mobile-header {
                display: block;
            }
            
            .banner {
                padding: 60px 0;
            }
            
            .banner h1 {
                font-size: 2.2rem;
            }
            
            .banner p {
                font-size: 1.1rem;
            }
            
            .section-title {
                font-size: 1.8rem;
            }
        }

        @media (max-width: 768px) {
            .product-view-container {
                padding: 0;
            }
            
            .product-view-image,
            .product-view-details {
                padding: 20px;
            }
            
            .product-view-title {
                font-size: 1.8rem;
            }
            
            .product-view-price {
                font-size: 1.5rem;
            }
            
            .product-view-meta {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 479px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .product-info {
                padding: 15px;
            }
            
            .product-title {
                font-size: 1rem;
                height: 2.4em;
            }
            
            .product-price {
                font-size: 1.1rem;
            }
            
            .product-actions {
                flex-direction: column;
                gap: 8px;
            }
            
            .view-btn,
            .add-to-cart-btn {
                padding: 10px;
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>
    <!-- Desktop Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo" onclick="showHomePage(); return false;">
                    <div class="logo-icon">
                        <i class="fas fa-store"></i>
                    </div>
                    <div class="logo-text">
                        <div class="logo-main">MUTANDA TRADERS</div>
                        <div class="logo-sub">PREMIUM QUALITY PRODUCTS</div>
                    </div>
                </a>
                
                <!-- Search Bar -->
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" 
                           class="search-box" 
                           id="searchBox" 
                           placeholder="Search products by name, category, or description..."
                           oninput="searchProducts(this.value)">
                    <div class="search-results" id="searchResults"></div>
                </div>
                
                <div class="header-actions">
                    <button class="cart-toggle" onclick="showCartPage()">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Cart</span>
                        <span class="cart-count" id="cartCount">0</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile Header -->
    <div class="mobile-header">
        <div class="container">
            <div class="mobile-header-content">
                <a href="#" class="mobile-logo" onclick="showHomePage(); return false;">
                    <div class="mobile-logo-icon">
                        <i class="fas fa-store"></i>
                    </div>
                    <div class="mobile-logo-text">MUTANDA TRADERS</div>
                </a>
                
                <div class="mobile-actions">
                    <button class="mobile-search-toggle" onclick="showMobileSearch()">
                        <i class="fas fa-search"></i>
                    </button>
                    
                    <button class="mobile-cart-btn" onclick="showCartPage()">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="mobile-cart-count" id="mobileCartCount">0</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Search Overlay -->
    <div class="mobile-search-overlay" id="mobileSearchOverlay">
        <div class="container">
            <div class="mobile-search-container">
                <i class="fas fa-search mobile-search-icon"></i>
                <input type="text" 
                       class="mobile-search-box" 
                       id="mobileSearchBox"
                       placeholder="Search products..."
                       oninput="searchProductsMobile(this.value)">
            </div>
            <button class="close-search" onclick="hideMobileSearch()">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <!-- Home Page -->
    <div id="homePage">
        <!-- Banner -->
        <section class="banner">
            <div class="container">
                <div class="banner-content">
                    <h1>Premium Quality Products at Unbeatable Prices</h1>
                    <p>Discover our exclusive collection of fashion, accessories, and lifestyle products. Fast delivery and exceptional customer service guaranteed.</p>
                    <button class="banner-btn" onclick="scrollToProducts()">
                        <i class="fas fa-shopping-bag"></i>
                        Start Shopping Now
                    </button>
                </div>
            </div>
        </section>

        <!-- Products Section -->
        <section class="products-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Featured Products</h2>
                    <p class="section-subtitle">Carefully selected items for your style and comfort</p>
                </div>
                <div id="productsGrid" class="products-grid">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>Loading products...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <div class="footer-content">
                    <div class="footer-section">
                        <h3>About Mutanda Traders</h3>
                        <p>Your trusted source for premium quality products at affordable prices. We're committed to providing excellent customer service and fast delivery.</p>
                    </div>
                    <div class="footer-section">
                        <h3>Contact Information</h3>
                        <div class="contact-info">
                            <div class="contact-item">
                                <i class="fas fa-phone"></i>
                                <span>+256 782 864 711</span>
                            </div>
                            <div class="contact-item">
                                <i class="fas fa-envelope"></i>
                                <span>info@mutandatraders.com</span>
                            </div>
                            <div class="contact-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>Kampala, Uganda</span>
                            </div>
                        </div>
                    </div>
                    <div class="footer-section">
                        <h3>Business Hours</h3>
                        <p>Monday - Friday: 8:00 AM - 6:00 PM</p>
                        <p>Saturday: 9:00 AM - 4:00 PM</p>
                        <p>Sunday: 10:00 AM - 2:00 PM</p>
                    </div>
                </div>
                
                <!-- Developer Credit -->
                <div class="developer-credit">
                    <div class="developer-info">
                        Developed by <strong>SERUSOFT</strong> | 
                        <a href="tel:+256704292425">0704292425</a> | 
                        <a href="mailto:serusoft4@gmail.com">serusoft4@gmail.com</a>
                    </div>
                </div>
                
                <div class="footer-bottom">
                    <p>&copy; 2024 Mutanda Traders. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Product View Page -->
    <div id="productViewPage" class="product-view-page hidden">
        <div class="container">
            <button class="back-btn" onclick="showHomePage()">
                <i class="fas fa-arrow-left"></i>
                Back to Products
            </button>
            
            <div class="product-view-container">
                <div class="product-view-content">
                    <div class="product-view-image">
                        <img id="productViewImage" src="" alt="Product Image" onclick="zoomImage(this)">
                    </div>
                    <div class="product-view-details">
                        <div class="product-view-header">
                            <h1 id="productViewTitle" class="product-view-title"></h1>
                            <div id="productViewPrice" class="product-view-price"></div>
                        </div>
                        <p id="productViewDescription" class="product-view-description"></p>
                        
                        <div class="product-view-meta">
                            <div class="meta-item">
                                <span class="meta-label">Availability</span>
                                <div class="meta-value">
                                    <span id="productViewStock" class="stock-badge"></span>
                                </div>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Category</span>
                                <div class="meta-value" id="productViewCategory"></div>
                            </div>
                            <div class="meta-item" id="viewSizeContainer" style="display: none;">
                                <span class="meta-label">Size</span>
                                <div class="meta-value" id="productViewSize"></div>
                            </div>
                            <div class="meta-item" id="viewColorContainer" style="display: none;">
                                <span class="meta-label">Color</span>
                                <div class="meta-value" id="productViewColor"></div>
                            </div>
                        </div>

                        <!-- Size Selector -->
                        <div class="size-selector hidden" id="sizeSelector">
                            <div class="selector-title">Select Size:</div>
                            <div class="size-options" id="sizeOptions">
                                <!-- Size options will be populated here -->
                            </div>
                        </div>
                        
                        <!-- Color Selector -->
                        <div class="color-selector hidden" id="colorSelector">
                            <div class="selector-title">Select Color:</div>
                            <div class="color-options" id="colorOptions">
                                <!-- Color options will be populated here -->
                            </div>
                        </div>
                        
                        <!-- Product Specifications -->
                        <div class="product-specifications" id="productSpecifications">
                            <h3 class="specifications-title">Specifications</h3>
                            <div class="specifications-grid" id="specificationsGrid">
                                <!-- Specifications will be populated here -->
                            </div>
                        </div>
                        
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateViewQuantity(-1)">-</button>
                            <span class="quantity-display" id="viewQuantity">1</span>
                            <button class="quantity-btn" onclick="updateViewQuantity(1)">+</button>
                        </div>
                        
                        <button class="buy-btn" id="buyButton" onclick="addToCartFromView()">
                            <i class="fas fa-cart-plus"></i>
                            Add to Cart
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Page -->
    <div id="cartPage" class="cart-page hidden">
        <div class="container">
            <div class="cart-container">
                <div class="cart-header">
                    <h2 class="cart-title">Your Shopping Cart</h2>
                    <div class="cart-actions">
                        <button class="continue-shopping" onclick="showHomePage()">
                            <i class="fas fa-arrow-left"></i>
                            Continue Shopping
                        </button>
                        <button class="clear-cart" onclick="clearCart()">
                            <i class="fas fa-trash-alt"></i>
                            Clear Cart
                        </button>
                    </div>
                </div>
                
                <div id="cartItems" class="cart-items">
                    <div class="empty-cart">
                        <p>Your cart is empty</p>
                    </div>
                </div>
                
                <div class="cart-summary">
                    <div class="summary-row">
                        <span>Subtotal:</span>
                        <span class="text-ugx">UGX <span id="cartSubtotal">0</span></span>
                    </div>
                    <div class="summary-row">
                        <span>Shipping:</span>
                        <div>
                            <span style="color: var(--primary-color); font-weight: 600;">Free</span>
                            <div class="shipping-note">
                                <i class="fas fa-info-circle"></i>
                                <span>Shipping fee will be agreed upon contact</span>
                            </div>
                        </div>
                    </div>
                    <div class="summary-row total">
                        <span>Total:</span>
                        <span class="total-amount text-ugx">UGX <span id="cartTotal">0</span></span>
                    </div>
                </div>
                
                <button class="checkout-btn" id="checkoutBtn" onclick="showCheckoutPage()" disabled>
                    <i class="fas fa-credit-card"></i>
                    <span>Proceed to Checkout</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Checkout Page -->
    <div id="checkoutPage" class="checkout-page hidden">
        <div class="container">
            <div class="checkout-container">
                <div class="checkout-header">
                    <h2 class="checkout-title">Complete Your Order</h2>
                    <p class="checkout-subtitle">Please fill in your details to complete the purchase</p>
                </div>
                
                <div class="checkout-content">
                    <div class="order-summary">
                        <h3 class="order-summary-title">Order Summary</h3>
                        <div id="checkoutItems" class="order-items">
                            <!-- Order items will be populated here -->
                        </div>
                        <div class="cart-summary">
                            <div class="summary-row">
                                <span>Subtotal:</span>
                                <span class="text-ugx">UGX <span id="checkoutSubtotal">0</span></span>
                            </div>
                            <div class="summary-row">
                                <span>Shipping:</span>
                                <span style="color: var(--primary-color); font-weight: 600;">Free (agreed on contact)</span>
                            </div>
                            <div class="summary-row total">
                                <span>Total:</span>
                                <span class="total-amount text-ugx">UGX <span id="checkoutTotal">0</span></span>
                            </div>
                        </div>
                    </div>
                    
                    <form id="checkoutForm">
                        <div class="form-group">
                            <label for="customerName" class="form-label">Full Name *</label>
                            <input type="text" id="customerName" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="email" class="form-label">Email Address *</label>
                            <input type="email" id="email" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="phone" class="form-label">Phone Number *</label>
                            <input type="tel" id="phone" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="address" class="form-label">Delivery Address *</label>
                            <textarea id="address" class="form-control" rows="3" required placeholder="Street address, city, postal code"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="paymentMethod" class="form-label">Payment Method *</label>
                            <div class="payment-methods">
                                <div class="payment-method" onclick="selectPaymentMethod('mobile-money')">
                                    <i class="fas fa-mobile-alt payment-icon"></i>
                                    <span class="payment-name">Mobile Money</span>
                                </div>
                                <div class="payment-method" onclick="selectPaymentMethod('bank-transfer')">
                                    <i class="fas fa-university payment-icon"></i>
                                    <span class="payment-name">Bank Transfer</span>
                                </div>
                                <div class="payment-method" onclick="selectPaymentMethod('cash-on-delivery')">
                                    <i class="fas fa-money-bill-wave payment-icon"></i>
                                    <span class="payment-name">Cash on Delivery</span>
                                </div>
                            </div>
                            <input type="hidden" id="paymentMethod" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="notes" class="form-label">Order Notes (Optional)</label>
                            <textarea id="notes" class="form-control" rows="2" placeholder="Any special instructions or requests..."></textarea>
                        </div>
                        
                        <div class="checkout-actions">
                            <button type="button" class="back-to-cart" onclick="showCartPage()">
                                <i class="fas fa-arrow-left"></i>
                                Back to Cart
                            </button>
                            <button type="submit" class="place-order">
                                <i class="fas fa-check"></i>
                                Place Order
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h3 class="modal-title">Order Placed Successfully!</h3>
            <div class="order-details">
                <h4>Order Details:</h4>
                <p><strong>Order ID:</strong> <span id="orderId">Loading...</span></p>
                <p><strong>Customer:</strong> <span id="orderCustomer">Loading...</span></p>
                <p><strong>Total Amount:</strong> <span id="orderAmount">Loading...</span></p>
                <p><strong>Payment Method:</strong> <span id="orderPayment">Loading...</span></p>
                <p><strong>Items:</strong> <span id="orderItems">Loading...</span></p>
            </div>
            <p class="modal-message">
                Thank you for your purchase! Your order has been received and is being processed. 
                We'll contact you shortly via WhatsApp for delivery arrangements and shipping fee agreement.
            </p>
            <button class="continue-btn" onclick="continueShoppingFromModal()">
                <i class="fas fa-shopping-bag"></i>
                Continue Shopping
            </button>
        </div>
    </div>

    <!-- Image Zoom Modal -->
    <div class="image-zoom-modal" id="imageZoomModal">
        <button class="close-zoom" onclick="closeZoom()">
            <i class="fas fa-times"></i>
        </button>
        <img class="zoomed-image" id="zoomedImage" src="" alt="Zoomed Image">
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toastNotification">
        <div class="toast-icon">
            <i class="fas fa-check-circle"></i>
        </div>
        <div class="toast-content">
            <div class="toast-title">Success</div>
            <div class="toast-message" id="toastMessage">Product added to cart!</div>
        </div>
    </div>

    <script>
    // Global variables
let allProducts = [];
let filteredProducts = [];
let cart = [];
let currentProductId = null;
let selectedPaymentMethod = '';
let viewQuantity = 1;
let currentProduct = null;
let selectedSize = null;
let selectedColor = null;
let searchTimeout = null;

// Disable PWA: Unregister any existing service workers
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations().then(function(registrations) {
        for(let registration of registrations) {
            registration.unregister();
        }
    });
}

// Initialize the app
document.addEventListener('DOMContentLoaded', function() {
    loadProductsFromFirestore();
    loadCartFromLocalStorage();
    
    // Set up checkout form
    document.getElementById('checkoutForm').addEventListener('submit', handleCheckout);
    
    // Initialize payment method selection
    initPaymentMethods();
    
    // Close search results when clicking outside
    document.addEventListener('click', function(event) {
        const searchResults = document.getElementById('searchResults');
        const searchBox = document.getElementById('searchBox');
        
        if (searchResults && searchBox && 
            !searchResults.contains(event.target) && 
            !searchBox.contains(event.target)) {
            searchResults.classList.remove('active');
        }
    });
});

// Format UGX currency
function formatUGX(amount) {
    return new Intl.NumberFormat('en-UG').format(Math.round(amount));
}

// Load products from Firestore
async function loadProductsFromFirestore() {
    try {
        showLoading('#productsGrid', 'Loading products...');
        
        const querySnapshot = await window.firestore.getDocs(
            window.firestore.collection(window.firestore.db, 'products')
        );
        
        allProducts = [];
        querySnapshot.forEach((doc) => {
            const productData = doc.data();
            allProducts.push({ 
                id: doc.id, 
                ...productData,
                // Ensure product has specifications object
                specifications: productData.specifications || {},
                sizes: productData.sizes || [],
                colors: productData.colors || []
            });
        });
        
        filteredProducts = [...allProducts];
        displayProducts();
    } catch (error) {
        console.error('Error loading products:', error);
        showError('#productsGrid', `Error loading products: ${error.message}`);
    }
}

// Display products in grid
function displayProducts() {
    const grid = document.getElementById('productsGrid');
    
    if (filteredProducts.length === 0) {
        grid.innerHTML = `
            <div style="text-align: center; padding: 60px; color: var(--light-text); grid-column: 1 / -1;">
                <i class="fas fa-box-open" style="font-size: 50px; color: var(--border-color); margin-bottom: 20px;"></i>
                <h3 style="margin-bottom: 15px; color: var(--dark-text);">No Products Found</h3>
                <p>Try adjusting your search or check back soon for our latest collection!</p>
            </div>
        `;
        return;
    }

    grid.innerHTML = filteredProducts.map(product => {
        const price = product.originalPrice || 0;
        const discountedPrice = product.discountedPrice || price;
        const hasDiscount = discountedPrice < price;
        const stockText = getStockText(product.stock);
        const productImage = product.image || getPlaceholderImage(product.category);
        const specs = product.specifications || {};
        
        // Create specs badges
        let specsHtml = '';
        if (specs.size) {
            specsHtml += `<span class="spec-badge">Size: ${specs.size}</span>`;
        }
        if (specs.color) {
            specsHtml += `<span class="spec-badge">Color: ${specs.color}</span>`;
        }
        if (specs.material) {
            specsHtml += `<span class="spec-badge">${specs.material}</span>`;
        }
        
        return `
            <div class="product-card">
                ${hasDiscount ? `<div class="product-badge">Sale</div>` : ''}
                <div class="product-image-container" onclick="viewProduct('${product.id}')">
                    <img src="${productImage}" 
                         alt="${product.name}" 
                         class="product-image"
                         loading="lazy"
                         onerror="this.src='${getPlaceholderImage(product.category)}'">
                    <div class="quick-view-overlay" onclick="event.stopPropagation(); viewProduct('${product.id}')">
                        <span class="quick-view-text">
                            <i class="fas fa-search-plus"></i>
                            Quick View
                        </span>
                    </div>
                </div>
                <div class="product-info">
                    <div class="product-category">${product.category || 'General'}</div>
                    <h3 class="product-title">${product.name}</h3>
                    ${specsHtml ? `<div class="product-specs">${specsHtml}</div>` : ''}
                    <div class="product-price">
                        ${hasDiscount ? `
                            <span style="text-decoration: line-through; color: var(--light-text); font-size: 0.9rem; margin-right: 8px;">
                                UGX ${formatUGX(price)}
                            </span>
                        ` : ''}
                        UGX ${formatUGX(discountedPrice)}
                    </div>
                    <div class="product-actions">
                        <button class="view-btn" onclick="viewProduct('${product.id}')">
                            <i class="fas fa-eye"></i>
                            View Details
                        </button>
                        <button class="add-to-cart-btn" 
                                onclick="addToCart('${product.id}')"
                                ${product.stock <= 0 ? 'disabled' : ''}>
                            <i class="fas fa-cart-plus"></i>
                            ${product.stock <= 0 ? 'Out of Stock' : 'Add to Cart'}
                        </button>
                    </div>
                </div>
            </div>
        `;
    }).join('');
}

// Search products
function searchProducts(searchTerm) {
    const searchResults = document.getElementById('searchResults');
    
    if (searchTimeout) {
        clearTimeout(searchTimeout);
    }
    
    searchTimeout = setTimeout(() => {
        if (!searchTerm.trim()) {
            filteredProducts = [...allProducts];
            searchResults.classList.remove('active');
            displayProducts();
            return;
        }
        
        const term = searchTerm.toLowerCase().trim();
        filteredProducts = allProducts.filter(product => {
            return (
                product.name.toLowerCase().includes(term) ||
                (product.category && product.category.toLowerCase().includes(term)) ||
                (product.description && product.description.toLowerCase().includes(term)) ||
                (product.specifications && 
                    Object.values(product.specifications).some(value => 
                        value && value.toString().toLowerCase().includes(term)
                    )
                )
            );
        });
        
        // Update search results dropdown
        if (filteredProducts.length > 0) {
            searchResults.innerHTML = filteredProducts.slice(0, 5).map(product => {
                const price = product.discountedPrice || product.originalPrice || 0;
                const image = product.image || getPlaceholderImage(product.category);
                
                return `
                    <div class="search-item" onclick="viewProduct('${product.id}'); document.getElementById('searchResults').classList.remove('active');">
                        <img src="${image}" alt="${product.name}" class="search-item-image" loading="lazy" onerror="this.src='${getPlaceholderImage('General')}'">
                        <div class="search-item-info">
                            <div class="search-item-name">${product.name}</div>
                            <div class="search-item-price">UGX ${formatUGX(price)}</div>
                        </div>
                    </div>
                `;
            }).join('');
            searchResults.classList.add('active');
        } else {
            searchResults.innerHTML = `
                <div class="no-results">
                    <i class="fas fa-search" style="font-size: 30px; margin-bottom: 10px; color: var(--light-text);"></i>
                    <p>No products found for "${searchTerm}"</p>
                </div>
            `;
            searchResults.classList.add('active');
        }
        
        // Update main grid
        displayProducts();
    }, 300);
}

// Search products on mobile
function searchProductsMobile(searchTerm) {
    if (!searchTerm.trim()) {
        filteredProducts = [...allProducts];
        displayProducts();
        return;
    }
    
    const term = searchTerm.toLowerCase().trim();
    filteredProducts = allProducts.filter(product => {
        return (
            product.name.toLowerCase().includes(term) ||
            (product.category && product.category.toLowerCase().includes(term)) ||
            (product.description && product.description.toLowerCase().includes(term))
        );
    });
    
    displayProducts();
}

// Show mobile search
function showMobileSearch() {
    document.getElementById('mobileSearchOverlay').classList.add('active');
    document.getElementById('mobileSearchBox').focus();
    document.body.style.overflow = 'hidden';
}

// Hide mobile search
function hideMobileSearch() {
    document.getElementById('mobileSearchOverlay').classList.remove('active');
    document.body.style.overflow = 'auto';
}

// Get stock text
function getStockText(stock) {
    if (stock > 10) return 'In Stock';
    if (stock > 0 && stock <= 10) return `Only ${stock} left`;
    return 'Out of Stock';
}

// Get stock class
function getStockClass(stock) {
    if (stock > 10) return 'stock-in';
    if (stock > 0 && stock <= 10) return 'stock-low';
    return 'stock-out';
}

// Get placeholder image
function getPlaceholderImage(category) {
    const categories = {
        'Shoes': 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjhmYWNhIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzFlNWYyMyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPlNob2VzPC90ZXh0Pjwvc3ZnPg==',
        'Dresses': 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjhmYWNhIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzFlNWYyMyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkRyZXNzZXM8L3RleHQ+PC9zdmc+',
        'T-shirts': 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjhmYWNhIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzFlNWYyMyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPlQtU2hpcnRzPC90ZXh0Pjwvc3ZnPg==',
        'Casual Wear': 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjhmYWNhIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzFlNWYyMyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkNhc3VhbCBXZWFyPC90ZXh0Pjwvc3ZnPg==',
        'Accessories': 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjhmYWNhIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzFlNWYyMyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkFjY2Vzc29yaWVzPC90ZXh0Pjwvc3ZnPg=='
    };
    return categories[category] || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjhmYWNhIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzFlNWYyMyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPlByb2R1Y3Q8L3RleHQ+PC9zdmc+';
}

// View product details
function viewProduct(productId) {
    const product = allProducts.find(p => p.id === productId);
    if (!product) return;
    
    currentProductId = productId;
    currentProduct = product;
    viewQuantity = 1;
    selectedSize = null;
    selectedColor = null;
    
    // Update product view page
    const price = product.originalPrice || 0;
    const discountedPrice = product.discountedPrice || price;
    const hasDiscount = discountedPrice < price;
    const stockText = getStockText(product.stock);
    const stockClass = getStockClass(product.stock);
    const specs = product.specifications || {};
    const sizes = product.sizes || [];
    const colors = product.colors || [];
    
    // Update image
    const productImage = document.getElementById('productViewImage');
    productImage.src = product.image || getPlaceholderImage(product.category);
    productImage.onerror = function() {
        this.src = getPlaceholderImage(product.category);
    };
    
    // Update basic info
    document.getElementById('productViewTitle').textContent = product.name;
    
    let priceHtml = `UGX ${formatUGX(discountedPrice)}`;
    if (hasDiscount) {
        priceHtml = `
            <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                <span style="text-decoration: line-through; color: var(--light-text); font-size: 1.4rem;">
                    UGX ${formatUGX(price)}
                </span>
                <span style="color: var(--primary-color);">UGX ${formatUGX(discountedPrice)}</span>
            </div>
        `;
    }
    document.getElementById('productViewPrice').innerHTML = priceHtml;
    
    document.getElementById('productViewDescription').textContent = 
        product.description || 'No description available.';
    
    document.getElementById('viewQuantity').textContent = viewQuantity;
    
    // Update stock badge
    const stockBadge = document.getElementById('productViewStock');
    stockBadge.textContent = stockText;
    stockBadge.className = `stock-badge ${stockClass}`;
    
    // Update category
    document.getElementById('productViewCategory').textContent = product.category || 'General';
    
    // Update Size (Single)
    const viewSizeContainer = document.getElementById('viewSizeContainer');
    if (product.size) {
        document.getElementById('productViewSize').textContent = product.size;
        viewSizeContainer.style.display = 'flex';
        if (sizes.length === 0) selectedSize = product.size;
    } else {
        viewSizeContainer.style.display = 'none';
    }

    // Update Color (Single)
    const viewColorContainer = document.getElementById('viewColorContainer');
    if (product.color) {
        document.getElementById('productViewColor').textContent = product.color;
        viewColorContainer.style.display = 'flex';
        if (colors.length === 0) selectedColor = product.color;
    } else {
        viewColorContainer.style.display = 'none';
    }

    // Update specifications
    const specificationsGrid = document.getElementById('specificationsGrid');
    if (Object.keys(specs).length > 0) {
        specificationsGrid.innerHTML = Object.entries(specs).map(([key, value]) => `
            <div class="spec-item">
                <span class="spec-label">${key.charAt(0).toUpperCase() + key.slice(1)}:</span>
                <span class="spec-value">${value}</span>
            </div>
        `).join('');
        document.getElementById('productSpecifications').classList.remove('hidden');
    } else {
        document.getElementById('productSpecifications').classList.add('hidden');
    }
    
    // Update size selector
    const sizeOptions = document.getElementById('sizeOptions');
    if (sizes.length > 0) {
        sizeOptions.innerHTML = sizes.map(size => `
            <div class="size-option ${selectedSize === size ? 'active' : ''}" 
                 onclick="selectSize('${size}')">
                ${size}
            </div>
        `).join('');
        document.getElementById('sizeSelector').classList.remove('hidden');
        if (!selectedSize && sizes.length > 0) {
            selectedSize = sizes[0];
            updateSizeSelection();
        }
    } else {
        document.getElementById('sizeSelector').classList.add('hidden');
    }
    
    // Update color selector
    const colorOptions = document.getElementById('colorOptions');
    if (colors.length > 0) {
        colorOptions.innerHTML = colors.map(color => `
            <div class="color-option ${selectedColor === color ? 'active' : ''}" 
                 onclick="selectColor('${color}')"
                 style="background-color: ${getColorValue(color)};"
                 title="${color}">
            </div>
        `).join('');
        document.getElementById('colorSelector').classList.remove('hidden');
        if (!selectedColor && colors.length > 0) {
            selectedColor = colors[0];
            updateColorSelection();
        }
    } else {
        document.getElementById('colorSelector').classList.add('hidden');
    }
    
    // Update buy button
    const buyButton = document.getElementById('buyButton');
    if (product.stock <= 0) {
        buyButton.disabled = true;
        buyButton.innerHTML = '<i class="fas fa-times"></i> Out of Stock';
        buyButton.style.opacity = '0.5';
    } else {
        buyButton.disabled = false;
        buyButton.innerHTML = '<i class="fas fa-cart-plus"></i> Add to Cart';
        buyButton.style.opacity = '1';
    }
    
    // Show product view page
    showProductViewPage();
}

// Get color value for CSS
function getColorValue(colorName) {
    const colorMap = {
        'red': '#ff0000',
        'blue': '#0000ff',
        'green': '#008000',
        'black': '#000000',
        'white': '#ffffff',
        'yellow': '#ffff00',
        'purple': '#800080',
        'pink': '#ffc0cb',
        'orange': '#ffa500',
        'brown': '#a52a2a',
        'gray': '#808080',
        'navy': '#000080',
        'maroon': '#800000',
        'teal': '#008080',
        'olive': '#808000'
    };
    return colorMap[colorName.toLowerCase()] || '#cccccc';
}

// Select size
function selectSize(size) {
    selectedSize = size;
    updateSizeSelection();
}

// Update size selection UI
function updateSizeSelection() {
    const sizeOptions = document.querySelectorAll('.size-option');
    sizeOptions.forEach(option => {
        if (option.textContent === selectedSize) {
            option.classList.add('active');
        } else {
            option.classList.remove('active');
        }
    });
}

// Select color
function selectColor(color) {
    selectedColor = color;
    updateColorSelection();
}

// Update color selection UI
function updateColorSelection() {
    const colorOptions = document.querySelectorAll('.color-option');
    colorOptions.forEach(option => {
        // Get the color from the title attribute or style
        const colorName = option.title || option.getAttribute('data-color') || '';
        if (colorName.toLowerCase() === selectedColor.toLowerCase()) {
            option.classList.add('active');
        } else {
            option.classList.remove('active');
        }
    });
}

// Update quantity in product view
function updateViewQuantity(change) {
    if (!currentProduct) return;
    
    const newQuantity = viewQuantity + change;
    if (newQuantity >= 1 && newQuantity <= currentProduct.stock) {
        viewQuantity = newQuantity;
        document.getElementById('viewQuantity').textContent = viewQuantity;
    } else if (newQuantity > currentProduct.stock) {
        showToast('Cannot add more items. Stock limit reached.', 'error');
    }
}

// Add to cart from home page
function addToCart(productId, quantity = 1) {
    const product = allProducts.find(p => p.id === productId);
    if (!product || product.stock <= 0) {
        showToast('Product is out of stock', 'error');
        return;
    }

    const price = product.discountedPrice || product.originalPrice || 0;
    const existingItemIndex = cart.findIndex(item => item.id === productId && 
        item.size === selectedSize && 
        item.color === selectedColor);
    
    const qtyToAdd = quantity || 1;
    
    if (existingItemIndex !== -1) {
        const newTotalQty = cart[existingItemIndex].quantity + qtyToAdd;
        if (newTotalQty <= product.stock) {
            cart[existingItemIndex].quantity = newTotalQty;
        } else {
            showToast('Cannot add more items. Stock limit reached.', 'error');
            return;
        }
    } else {
        if (qtyToAdd > product.stock) {
            showToast('Cannot add more items. Stock limit reached.', 'error');
            return;
        }
        cart.push({
            id: productId,
            name: product.name,
            price: price,
            image: product.image || getPlaceholderImage(product.category),
            quantity: qtyToAdd,
            maxStock: product.stock,
            size: selectedSize,
            color: selectedColor,
            specs: product.specifications || {}
        });
    }

    updateCartDisplay();
    updateCheckoutDisplay();
    saveCartToLocalStorage();
    showToast(`Added ${qtyToAdd} ${qtyToAdd === 1 ? 'item' : 'items'} to cart!`, 'success');
    
    // Reset selections if not in product view
    if (document.getElementById('productViewPage').classList.contains('hidden')) {
        selectedSize = null;
        selectedColor = null;
    }
}

// Add to cart from product view page
function addToCartFromView() {
    if (currentProductId && viewQuantity > 0) {
        addToCart(currentProductId, viewQuantity);
    }
}

// Update cart display
function updateCartDisplay() {
    const cartCount = document.getElementById('cartCount');
    const mobileCartCount = document.getElementById('mobileCartCount');
    const cartSubtotal = document.getElementById('cartSubtotal');
    const cartTotal = document.getElementById('cartTotal');
    const checkoutBtn = document.getElementById('checkoutBtn');

    const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    const total = subtotal;

    const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
    cartCount.textContent = totalItems;
    mobileCartCount.textContent = totalItems;
    cartSubtotal.textContent = formatUGX(subtotal);
    cartTotal.textContent = formatUGX(total);
    
    // Update cart items display
    const cartItems = document.getElementById('cartItems');
    
    if (cart.length === 0) {
        cartItems.innerHTML = `
            <div style="text-align: center; padding: 60px; color: var(--light-text);">
                <i class="fas fa-shopping-cart" style="font-size: 50px; color: var(--border-color); margin-bottom: 20px;"></i>
                <h3 style="margin-bottom: 15px; color: var(--dark-text);">Your Cart is Empty</h3>
                <p style="color: var(--light-text); margin-bottom: 20px;">Add some products to get started!</p>
                <button onclick="showHomePage()" style="background: var(--primary-color); color: white; border: none; padding: 12px 30px; border-radius: var(--border-radius-md); cursor: pointer; font-weight: 600; transition: all var(--transition-fast);">
                    <i class="fas fa-shopping-bag"></i>
                    Browse Products
                </button>
            </div>
        `;
        checkoutBtn.disabled = true;
    } else {
        cartItems.innerHTML = cart.map((item, index) => {
            let specsHtml = '';
            if (item.size) {
                specsHtml += `<span class="cart-item-spec">Size: ${item.size}</span>`;
            }
            if (item.color) {
                specsHtml += `<span class="cart-item-spec">Color: ${item.color}</span>`;
            }
            
            return `
                <div class="cart-item">
                    <img src="${item.image}" alt="${item.name}" class="cart-item-image" loading="lazy" onerror="this.src='${getPlaceholderImage('General')}'">
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        ${specsHtml ? `<div class="cart-item-specs">${specsHtml}</div>` : ''}
                        <div class="cart-item-price">UGX ${formatUGX(item.price)} each</div>
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">-</button>
                            <span class="quantity-display">${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
                            <button class="remove-item" onclick="removeFromCart(${index})">
                                <i class="fas fa-trash-alt"></i>
                                Remove
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }).join('');
        checkoutBtn.disabled = false;
    }
}

// Update checkout display
function updateCheckoutDisplay() {
    const checkoutSubtotal = document.getElementById('checkoutSubtotal');
    const checkoutTotal = document.getElementById('checkoutTotal');
    const checkoutItems = document.getElementById('checkoutItems');
    
    const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    const total = subtotal;
    
    checkoutSubtotal.textContent = formatUGX(subtotal);
    checkoutTotal.textContent = formatUGX(total);
    
    checkoutItems.innerHTML = cart.map(item => {
        let specsText = '';
        if (item.size || item.color) {
            specsText = ` (${[item.size, item.color].filter(Boolean).join(', ')})`;
        }
        
        return `
            <div class="order-item">
                <div>
                    <div class="order-item-name">${item.name}${specsText}</div>
                    <div class="order-item-quantity">Qty: ${item.quantity}</div>
                </div>
                <div class="order-item-price">UGX ${formatUGX(item.price * item.quantity)}</div>
            </div>
        `;
    }).join('');
}

// Update quantity in cart
function updateQuantity(index, change) {
    const item = cart[index];
    if (!item) return;

    const newQuantity = item.quantity + change;
    if (newQuantity <= 0) {
        removeFromCart(index);
    } else if (newQuantity <= item.maxStock) {
        item.quantity = newQuantity;
        updateCartDisplay();
        updateCheckoutDisplay();
        saveCartToLocalStorage();
    } else {
        showToast('Cannot add more items. Stock limit reached.', 'error');
    }
}

// Remove from cart
function removeFromCart(index) {
    if (index >= 0 && index < cart.length) {
        cart.splice(index, 1);
        updateCartDisplay();
        updateCheckoutDisplay();
        saveCartToLocalStorage();
        showToast('Product removed from cart', 'success');
    }
}

// Clear cart
function clearCart() {
    if (cart.length === 0) return;
    if (confirm('Are you sure you want to clear your cart? This action cannot be undone.')) {
        cart = [];
        updateCartDisplay();
        updateCheckoutDisplay();
        saveCartToLocalStorage();
        showToast('Cart cleared', 'success');
    }
}

// Save cart to localStorage
function saveCartToLocalStorage() {
    localStorage.setItem('mutandaTradersCart', JSON.stringify(cart));
}

// Load cart from localStorage
function loadCartFromLocalStorage() {
    const savedCart = localStorage.getItem('mutandaTradersCart');
    if (savedCart) {
        try {
            cart = JSON.parse(savedCart);
            updateCartDisplay();
            updateCheckoutDisplay();
        } catch (e) {
            console.error('Error loading cart from localStorage:', e);
            cart = [];
        }
    }
}

// Initialize payment methods
function initPaymentMethods() {
    const methods = document.querySelectorAll('.payment-method');
    methods.forEach(method => {
        method.addEventListener('click', function() {
            methods.forEach(m => m.classList.remove('active'));
            this.classList.add('active');
            selectedPaymentMethod = this.getAttribute('onclick').match(/'(.*?)'/)[1];
            document.getElementById('paymentMethod').value = selectedPaymentMethod;
        });
    });
}

// Select payment method
function selectPaymentMethod(method) {
    selectedPaymentMethod = method;
    document.getElementById('paymentMethod').value = method;
    
    const methods = document.querySelectorAll('.payment-method');
    methods.forEach(m => m.classList.remove('active'));
    
    const selected = document.querySelector(`.payment-method[onclick*="${method}"]`);
    if (selected) selected.classList.add('active');
}

// Page navigation functions
function showHomePage() {
    document.getElementById('homePage').classList.remove('hidden');
    document.getElementById('productViewPage').classList.add('hidden');
    document.getElementById('cartPage').classList.add('hidden');
    document.getElementById('checkoutPage').classList.add('hidden');
    document.getElementById('successModal').classList.remove('active');
    document.getElementById('imageZoomModal').classList.remove('active');
    document.getElementById('mobileSearchOverlay').classList.remove('active');
    document.body.style.overflow = 'auto';
    window.scrollTo(0, 0);
    
    // Reset search and show all products
    filteredProducts = [...allProducts];
    displayProducts();
    document.getElementById('searchBox').value = '';
    document.getElementById('searchResults').classList.remove('active');
}

function showProductViewPage() {
    document.getElementById('homePage').classList.add('hidden');
    document.getElementById('productViewPage').classList.remove('hidden');
    document.getElementById('cartPage').classList.add('hidden');
    document.getElementById('checkoutPage').classList.add('hidden');
    document.getElementById('imageZoomModal').classList.remove('active');
    document.getElementById('mobileSearchOverlay').classList.remove('active');
    document.body.style.overflow = 'auto';
    window.scrollTo(0, 0);
}

function showCartPage() {
    document.getElementById('homePage').classList.add('hidden');
    document.getElementById('productViewPage').classList.add('hidden');
    document.getElementById('cartPage').classList.remove('hidden');
    document.getElementById('checkoutPage').classList.add('hidden');
    document.getElementById('imageZoomModal').classList.remove('active');
    document.getElementById('mobileSearchOverlay').classList.remove('active');
    document.body.style.overflow = 'auto';
    window.scrollTo(0, 0);
}

function showCheckoutPage() {
    if (cart.length === 0) return;
    document.getElementById('homePage').classList.add('hidden');
    document.getElementById('productViewPage').classList.add('hidden');
    document.getElementById('cartPage').classList.add('hidden');
    document.getElementById('checkoutPage').classList.remove('hidden');
    document.getElementById('imageZoomModal').classList.remove('active');
    document.getElementById('mobileSearchOverlay').classList.remove('active');
    document.body.style.overflow = 'auto';
    window.scrollTo(0, 0);
}

// Continue shopping from modal
function continueShoppingFromModal() {
    document.getElementById('successModal').classList.remove('active');
    showHomePage();
}

// Scroll to products
function scrollToProducts() {
    const productsSection = document.querySelector('.products-section');
    if (productsSection) {
        productsSection.scrollIntoView({ behavior: 'smooth' });
    }
}

// Image zoom functionality
function zoomImage(imgElement) {
    const zoomModal = document.getElementById('imageZoomModal');
    const zoomedImage = document.getElementById('zoomedImage');
    
    zoomedImage.src = imgElement.src;
    zoomedImage.alt = imgElement.alt;
    zoomModal.classList.add('active');
    document.body.style.overflow = 'hidden';
}

function closeZoom() {
    document.getElementById('imageZoomModal').classList.remove('active');
    document.body.style.overflow = 'auto';
}

// Send WhatsApp notification via backend webhook
async function sendWhatsAppNotification(orderData) {
    // Twilio Configuration
    const accountSid = 'AC10091923685d248d39154165106691d4';
    const authToken = '0a740df7c6d2bad1001a9e9b514bb3d9'.trim();
    const fromNumber = 'whatsapp:+14155238886';
    const toNumber = 'whatsapp:+256782864711';

    // Construct the message body with order details
    const itemsList = orderData.products.map(p => `${p.quantity}x ${p.name}`).join('\n');
    const messageBody = `*New Order Received!* \n\n` +
        `*Order ID:* ${orderData.orderId}\n` +
        `*Customer:* ${orderData.customerName}\n` +
        `*Phone:* ${orderData.phone}\n` +
        `*Total:* UGX ${new Intl.NumberFormat('en-UG').format(orderData.totalPrice)}\n` +
        `*Payment:* ${orderData.paymentMethod}\n\n` +
        `*Items:*\n${itemsList}`;

    const url = `https://api.twilio.com/2010-04-01/Accounts/${accountSid}/Messages.json`;
    const formData = new URLSearchParams();
    formData.append('To', toNumber);
    formData.append('From', fromNumber);
    formData.append('Body', messageBody);

    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: {
                'Authorization': 'Basic ' + btoa(accountSid + ':' + authToken),
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: formData
        });

        if (response.ok) {
            const result = await response.json();
            console.log(' WhatsApp notification sent successfully:', result.sid);
            showToast('WhatsApp notification sent!', 'success');
        } else {
            const error = await response.json();
            console.error(' Failed to send WhatsApp notification:', JSON.stringify(error));
            showToast('Twilio Error: ' + (error.message || error.code || 'Unauthorized'), 'error');
        }
    } catch (error) {
        console.error(' Error sending WhatsApp notification:', error);
        if (error.name === 'TypeError' && error.message === 'Failed to fetch') {
            showToast('WhatsApp Error: Browser blocked request (CORS)', 'error');
            console.warn(' CORS Error: Browsers block direct Twilio API calls. You may need a backend or a browser extension to test this.');
        } else {
            showToast('Error sending WhatsApp: ' + error.message, 'error');
        }
    }
}

// Handle checkout
async function handleCheckout(e) {
    e.preventDefault();
    
    if (!selectedPaymentMethod) {
        showToast('Please select a payment method', 'error');
        return;
    }
    
    const submitBtn = e.target.querySelector('button[type="submit"]');
    const originalBtnText = submitBtn.innerHTML;
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing Order...';
    
    try {
        // Validate form inputs
        const customerName = document.getElementById('customerName').value.trim();
        const email = document.getElementById('email').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const deliveryAddress = document.getElementById('address').value.trim();
        
        if (!customerName || !email || !phone || !deliveryAddress) {
            showToast('Please fill in all required fields', 'error');
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalBtnText;
            return;
        }

        const orderData = {
            customerName: customerName,
            email: email,
            phone: phone,
            deliveryAddress: deliveryAddress,
            paymentMethod: selectedPaymentMethod,
            orderNotes: document.getElementById('notes').value,
            products: cart.map(item => ({
                id: item.id,
                name: item.name,
                price: item.price,
                image: item.image,
                quantity: item.quantity,
                size: item.size,
                color: item.color,
                subtotal: item.price * item.quantity
            })),
            subtotal: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
            shipping: 0,
            totalPrice: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
            status: 'Pending',
            orderDate: window.firestore.serverTimestamp(),
            createdAt: window.firestore.serverTimestamp()
        };

        console.log(' Placing order:', orderData);

        // Save order to Firestore
        const orderRef = await window.firestore.addDoc(
            window.firestore.collection(window.firestore.db, 'orders'), 
            orderData
        );
        
        console.log(' Order created with ID:', orderRef.id);

        // Update order data with ID
        orderData.orderId = orderRef.id;

        // Update product stock
        for (const item of cart) {
            const productRef = window.firestore.doc(window.firestore.db, 'products', item.id);
            await window.firestore.updateDoc(productRef, {
                stock: window.firestore.increment(-item.quantity)
            });
        }

        // Send WhatsApp notification
        await sendWhatsAppNotification(orderData);
        
        // Update success modal with order details
        document.getElementById('orderId').textContent = orderRef.id;
        document.getElementById('orderCustomer').textContent = orderData.customerName;
        document.getElementById('orderAmount').textContent = `UGX ${formatUGX(orderData.totalPrice)}`;
        document.getElementById('orderPayment').textContent = orderData.paymentMethod;
        document.getElementById('orderItems').textContent = `${cart.length} item${cart.length !== 1 ? 's' : ''}`;
        
        // Show success modal
        document.getElementById('successModal').classList.add('active');
        
        // Clear cart
        cart = [];
        updateCartDisplay();
        updateCheckoutDisplay();
        saveCartToLocalStorage();
        
        // Reset form
        document.getElementById('checkoutForm').reset();
        selectedPaymentMethod = '';
        document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('active'));
        
    } catch (error) {
        console.error(' Error placing order:', error);
        console.error('Error code:', error.code);
        console.error('Error message:', error.message);
        
        let userMessage = error.message;
        if (error.code === 'permission-denied') {
            userMessage = 'Permission denied. Please check Firestore security rules.';
        } else if (error.code === 'invalid-argument') {
            userMessage = 'Invalid order data. Please check all fields are filled correctly.';
        }
        
        showToast(`Error: ${userMessage}`, 'error');
    } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalBtnText;
    }
}

// Show toast notification
function showToast(message, type = 'success') {
    const toast = document.getElementById('toastNotification');
    const toastMessage = document.getElementById('toastMessage');
    const toastIcon = toast.querySelector('.toast-icon i');
    
    toastMessage.textContent = message;
    toast.className = 'toast';
    
    switch (type) {
        case 'error':
            toastIcon.className = 'fas fa-exclamation-circle';
            toast.classList.add('toast-error');
            break;
        case 'warning':
            toastIcon.className = 'fas fa-exclamation-triangle';
            toast.classList.add('toast-warning');
            break;
        default:
            toastIcon.className = 'fas fa-check-circle';
            toast.classList.add('toast-success');
    }
    
    toast.classList.add('show');
    
    setTimeout(() => {
        toast.classList.remove('show');
    }, 4000);
}

// Show loading state
function showLoading(selector, message) {
    const element = document.querySelector(selector);
    if (element) {
        element.innerHTML = `
            <div class="loading">
                <div class="loading-spinner"></div>
                <p>${message}</p>
            </div>
        `;
    }
}

// Show error state
function showError(selector, message) {
    const element = document.querySelector(selector);
    if (element) {
        element.innerHTML = `
            <div style="text-align: center; padding: 60px; color: var(--danger-color); grid-column: 1 / -1;">
                <i class="fas fa-exclamation-triangle" style="font-size: 50px; margin-bottom: 20px;"></i>
                <h3 style="margin-bottom: 15px; color: var(--dark-text);">Failed to Load Products</h3>
                <p style="color: var(--light-text); margin-bottom: 20px;">${message}</p>
                        <button onclick="loadProductsFromFirestore()" style="background: var(--primary-color); color: white; border: none; padding: 12px 30px; border-radius: var(--border-radius-md); cursor: pointer; font-weight: 600; transition: all var(--transition-fast);">
                            <i class="fas fa-redo"></i>
                            Try Again
                        </button>
                    </div>
                `;
            }
        }

        // Export functions to global scope for onclick handlers
        window.viewProduct = viewProduct;
        window.addToCart = addToCart;
        window.showHomePage = showHomePage;
        window.showCartPage = showCartPage;
        window.showProductViewPage = showProductViewPage;
        window.showCheckoutPage = showCheckoutPage;
        window.continueShoppingFromModal = continueShoppingFromModal;
        window.scrollToProducts = scrollToProducts;
        window.zoomImage = zoomImage;
        window.closeZoom = closeZoom;
        window.showMobileSearch = showMobileSearch;
        window.hideMobileSearch = hideMobileSearch;
        window.clearCart = clearCart;
        window.selectPaymentMethod = selectPaymentMethod;
        window.updateViewQuantity = updateViewQuantity;
        window.addToCartFromView = addToCartFromView;
        window.selectSize = selectSize;
        window.selectColor = selectColor;
        window.updateSizeSelection = updateSizeSelection;
        window.updateColorSelection = updateColorSelection;
        window.searchProducts = searchProducts;
        window.searchProductsMobile = searchProductsMobile;
        window.updateQuantity = updateQuantity;
        window.removeFromCart = removeFromCart;
    </script>
</body>
</html>
</html>